% Author: Alessio Botta 2008
% Luca Verginer 2019
% Andrea Ceravolo 2020

\ProvidesClass{phdimt}[]
\DeclareOption*{\PassOptionsToClass{\CurrentOption}{book}}
\ProcessOptions\relax
\LoadClass[pdftex,a5paper]{book}

% Packages and some basic initialisation

\usepackage{subfigure}
\usepackage{graphics}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage[margin=10pt,font=small,labelfont=bf]{caption}
\setlength{\belowcaptionskip}{5pt}
\setlength{\abovecaptionskip}{5pt}
\usepackage[english]{babel}
\usepackage[usenames,dvipsnames]{color}
\usepackage[backend=biber,natbib=true,style=authoryear]{biblatex}
\usepackage{csquotes}
\usepackage{etoolbox}
\usepackage{ifthen}
\usepackage{multirow}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[twoside=false,a5paper,bottom=1.5cm,top=1.8cm,right=1.8cm,left=1.8cm,includefoot]{geometry}
\usepackage{pifont}
\usepackage{palatino}
\usepackage[ pdftex, plainpages = false, pdfpagelabels,
pdfpagelayout = useoutlines,
bookmarks,
bookmarksopen = true,
bookmarksnumbered = true,
breaklinks = true,
linktocpage,
colorlinks = false,
linkcolor = blue,
urlcolor  = blue,
citecolor = red,
anchorcolor = green,
hyperindex = true,
hyperfigures
]{hyperref}
\DeclareGraphicsExtensions{.png, .jpg, .jpeg, .pdf, .gif}
\usepackage[pdftex]{graphicx}
\pdfcompresslevel=9

% Compile using the PDF/A-2B standard
\usepackage[a-2b]{pdfx}
\usepackage{colorprofiles}

% A5 settings

\pdfpageheight=210mm
\pdfpagewidth=148mm
\setlength{\marginparsep}{0pt}
% \setlength{\marginparwidth}{0pt}

% DECLARATIONS
% These macros are used to declare arguments needed for the
% construction of the title page and other preamble.

\def\program#1{\gdef\@program{#1}}
\def\track#1{\gdef\@track{#1}}
\def\curriculum#1{\gdef\@curriculum{#1}}
\def\cycle#1{\gdef\@cycle{#1}}
\def\pubyear#1{\gdef\@pubyear{#1}}
\def\mail#1{\gdef\@mail{#1}}

\def\advisor#1{\gdef\@advisor{#1}}
\def\coadvisor#1{\gdef\@coadvisor{#1}}
\def\secondcoadvisor#1{\gdef\@secondcoadvisor{#1}}
\def\advisorinst#1{\gdef\@advisorinst{#1}}
\def\coadvisorinst#1{\gdef\@coadvisorinst{#1}}
\def\secondcoadvisorinst#1{\gdef\@secondcoadvisorinst{#1}}

\def\coordinator#1{\gdef\@coordinator{#1}}
\def\coordinatorinst#1{\gdef\@coordinatorinst{#1}}

\def\firstreviewer#1{\gdef\@firstreviewer{#1}}
\def\firstreviewerinst#1{\gdef\@firstreviewerinst{#1}}
\def\secondreviewer#1{\gdef\@secondreviewer{#1}}
\def\secondreviewerinst#1{\gdef\@secondreviewerinst{#1}}
\def\thirdreviewer#1{\gdef\@thirdreviewer{#1}}
\def\thirdreviewerinst#1{\gdef\@thirdreviewerinst{#1}}

\newcommand{\insertblankpage}{
\newpage
{\ \par}
\newpage
}

% TITLE PAGE
% The title page is generated by overloading the \maketitle command
% added a more granular title block

\newcommand{\IMT}{IMT School for Advanced Studies Lucca}

\renewcommand{\maketitle}{%
% \null\vfill
\begin{center}
%    {\vspace*{1.5em} \includegraphics[width=6cm]{backmatter/logo_imt.png} \vspace*{2cm}}\\
    {\large \bf IMT School for Advanced Studies, Lucca \par }
    {\large Lucca, Italy \par \vspace*{3em}}
    {\large \bf \@title \par \vspace*{3em}}
    {\large PhD Program in \@program \par \vspace*{0.5em}}
    \ifcsdef{@track}{\large Track in \@track \par \vspace*{0.5em}}{}
    \ifcsdef{@curriculum}{\large Curriculum in \@curriculum \par \vspace*{1em}}{}
    {\large \@cycle { Cycle} \par \vspace*{12em}}
    {\large \bf {By} \par \vspace*{1em}}
    {\large \bf \href{mailto:\@mail}{\@author} \par \vspace*{1em}}
    {\large \bf \@pubyear}
\end{center}
\null\vfill
\insertblankpage
}

% REVIEWERS PAGE
% Some extra comments or customizations should be added in case of more/less than three reviewers and/or no cosupervision

\newcommand{\makereviewerspage}{
\null\vfill
\begin{center}
    {\large \bf The dissertation of \@author { is approved.} \par \vspace*{2em}}
\end{center}

\begin{flushleft}
{PhD Program Coordinator: \@coordinator, \@coordinatorinst \par \vspace*{2em}}
{Advisor: \@advisor, \@advisorinst \par \vspace*{2em}}
\ifcsdef{@coadvisor}{Co-Advisor: \@coadvisor, \@coadvisorinst \par \vspace*{2em}}{}
\ifcsdef{@secondcoadvisor}{Co-Advisor: \@secondcoadvisor, \@secondcoadvisorinst \par \vspace*{4em}}{}
\end{flushleft}

\begin{center}
    {The dissertation of \@author { has been reviewed by:} \par \vspace*{2em}}
\end{center}
{\@firstreviewer, \@firstreviewerinst \par \vspace*{2em}}
\ifcsdef{@secondreviewer}{\@secondreviewer, \@secondreviewerinst \par \vspace*{2em}}{}
\ifcsdef{@thirdreviewer}{\@thirdreviewer, \@thirdreviewerinst \par \vspace*{2em}}{}
\begin{center}
    {\IMT \par}
    {\@pubyear}
\end{center}
\null\vfill
\insertblankpage
}

% DEDICATION

\newenvironment{dedication}{
\begin{center}
    \vspace*{1.5cm}
    {\LARGE }
\end{center}
\vspace{0.5cm}
\begin{quote} \begin{center}
    }
    % content
    {
\end{center} \end{quote}
\insertblankpage
}


% ACKNOWLEDGEMENTS

\newenvironment{acknowledgements}{
\begin{center}
    \vspace*{0.5cm}
    {\Large \bfseries Acknowledgements}
\end{center}
\vspace{0.5cm}
\begin{quote}
    }
    % content
    {
\end{quote}
}

% ABSTRACT

\newenvironment{abstract} {
\begin{center}
    \vspace*{0.5cm}
    {\Large \bfseries  Abstract}
\end{center}
\vspace{0.5cm}
\begin{quote}
    }
    % content
    {
\end{quote}
}

% COPYRIGHT STATEMENT

\newcommand{\makecopyright}{

\pagestyle{empty}
\insertblankpage
\null\vfill
\begin{center}
    \href{https://creativecommons.org/licenses/by-nc-sa/3.0/it/}{\includegraphics[width=2in]{backmatter/by-nc-sa.png}}
\end{center}

\begin{quote}
    \small{
Unless otherwise expressly stated, all original material of whatever nature created by \@author \ and included in this thesis, is licensed under a \href{https://creativecommons.org/licenses/by-nc-sa/3.0/it/}{Creative Commons Attribution Noncommercial Share Alike 3.0 Italy License}.

Check on Creative Commons site:

\href{https://creativecommons.org/licenses/by-nc-sa/3.0/it/legalcode/}{https://creativecommons.org/licenses/by-nc-sa/3.0/it/legalcode/}

\href{https://creativecommons.org/licenses/by-nc-sa/3.0/it/deed.en}{https://creativecommons.org/licenses/by-nc-sa/3.0/it/deed.en}}

\href{mailto:\@mail}{Ask the author} about other uses.

\end{quote}

}

% Page numbering
\usepackage{chngcntr}
\pagestyle{plain} % show only page numbers
\counterwithout{figure}{chapter} % unbind figures from chapters
\counterwithout{table}{chapter} % unbind tables from chapters
